<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="app-title">DRK: Comparador Multitarifa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // --- Tailwind CSS Configuration ---
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        drk: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            400: '#38bdf8', /* Lighter Blue for Active Hover */
                            500: '#0ea5e9',
                            600: '#0284c7',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        powercup: {
                            50: '#f7fee7',
                            100: '#ecfccb',
                            400: '#a3e635', /* Lighter Green for Active Hover */
                            500: '#84cc16',
                            600: '#65a30d',
                            800: '#3f6212',
                            900: '#365314',
                            'yellow-flash': '#facc15',
                        },
                        'cta-red': {
                            500: '#CC0000',
                            600: '#A00000',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        /* --- General and Utility Styles --- */
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        #interactive.viewport { position: relative; width: 100%; height: auto; overflow: hidden; border-radius: 1rem; }
        #interactive.viewport > video { width: 100%; height: 100%; object-fit: cover; }
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .mode-selector { border: 2px solid; }

        /* Estilos de los botones de selección de tarifa (Landing Page) */
        .tariff-select-btn {
            display: flex;
            align-items: center;
            width: 100%;
            padding: 1rem; /* p-4 */
            background-color: white;
            border-radius: 1rem; /* rounded-xl */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.06); /* shadow-lg */
            transition: all 0.3s ease;
            border: 1px solid #e2e8f0; /* slate-200 */
        }
        
        /* DRK Active Hover Styles (Default) */
        .drk-active .tariff-select-btn:hover {
            border-color: #0ea5e9; /* drk-500 */
            background-color: #f0f9ff; /* drk-50 */
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(14, 165, 233, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
        }
        .drk-active .tariff-select-btn:hover .arrow-icon {
            color: #0ea5e9; /* drk-500 */
        }

        /* POWER CUP Active Hover Styles */
        .powercup-active .tariff-select-btn:hover {
            border-color: #84cc16; /* powercup-500 */
            background-color: #f7fee7; /* powercup-50 */
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(132, 204, 22, 0.2), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
        }
        .powercup-active .tariff-select-btn:hover .arrow-icon {
            color: #84cc16; /* powercup-500 */
        }


        .icon-wrapper {
            padding: 0.75rem; /* p-3 */
            border-radius: 0.75rem; /* rounded-xl */
            margin-right: 1rem; /* mr-4 */
            flex-shrink: 0;
            transition: background-color 0.3s;
        }

        .arrow-icon {
            margin-left: auto;
            font-size: 1.5rem;
            color: #94a3b8; /* slate-400 */
            transition: color 0.3s ease;
        }

        /* Estilos QR */
        #qr-content-wrapper { transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out; overflow: hidden; max-height: 0; opacity: 0; }
        #qr-content-wrapper.active { max-height: 500px; opacity: 1; }
        #qr-visual-container { 
            position: relative; 
            display: inline-block; 
            background-color: white; 
            border-radius: 1rem; 
            padding: 1rem; 
            border: 4px solid var(--qr-border-color, #0ea5e9); 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
        }
        /* Texto central del QR */
        #qr-visual-container::before { 
            content: var(--qr-center-text, "DRK"); 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            font-size: 20px; /* Tamaño reducido para no cubrir tanto */
            font-weight: bold; 
            color: #ffffff; 
            background-color: var(--qr-center-bg, #0c4a6e); 
            padding: 4px 8px; /* Padding reducido */
            border-radius: 6px; 
            z-index: 10; 
            opacity: 0.95; 
            min-width: 60px;
            text-align: center;
        }
        
        /* Ocultar elementos dependiendo del tipo de tarifa */
        .hidden-period { display: none; }
        
        /* Estilos para el campo de pegado temporal (FIX para Ctrl+V) */
        #paste-catcher {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: -1; /* Oculto por defecto */
            width: 0;
            height: 0;
            opacity: 0;
            pointer-events: none;
            transition: all 0.15s ease-in-out;
            resize: none;
        }

        #paste-catcher.pasting-active {
            width: 200px; 
            height: 100px; 
            opacity: 0.01; /* Debe ser casi transparente, pero no 0 */
            z-index: 1000; /* Siempre visible cuando activo */
            pointer-events: auto;
            border: 4px dashed var(--qr-border-color, #0ea5e9);
            background-color: white;
        }
    </style>
    <!-- Librerías QR -->
    <script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
</head>
<body class="flex flex-col min-h-screen text-slate-800">

    <!-- Navbar Global -->
    <div id="navbar" class="w-full bg-drk-900 text-white p-4 shadow-md sticky top-0 z-50 transition-colors duration-300">
        <div class="max-w-lg mx-auto flex justify-between items-center">
            <h1 class="text-xl font-bold tracking-tight cursor-pointer" onclick="resetToLanding()">
                <span id="app-logo-main">DRK</span> <span class="text-drk-500" id="app-logo-accent">Energía</span>
            </h1>
            <span class="text-xs bg-drk-800 px-2 py-1 rounded text-drk-100" id="app-subtitle">Selector</span>
        </div>
    </div>

    <div id="app" class="w-full max-w-lg mx-auto p-4 md:p-6 flex-grow">

        <!-- 1. LANDING PAGE (SELECCIÓN DE TARIFA) -->
        <div id="landing-view" class="fade-in flex flex-col items-center justify-center min-h-[60vh] py-8">
            <div class="bg-white p-6 md:p-8 rounded-3xl shadow-2xl w-full border-t-4 border-drk-500" id="landing-card">
                <div id="landing-icon-bg" class="w-16 h-16 bg-drk-50 rounded-full flex items-center justify-center mx-auto mb-4 text-drk-600 shadow-inner">
                    <!-- Logo DRK SVG -->
                    <svg class="w-8 h-8" viewBox="0 0 100 100" fill="none">
                        <style>.drk-ring{fill:none;stroke-width:10;stroke-linecap:round;}</style>
                        <circle class="drk-ring" cx="45" cy="45" r="35" stroke="#E50000"/>
                        <circle class="drk-ring" cx="55" cy="55" r="35" stroke="#FFCC00"/>
                        <circle class="drk-ring" cx="45" cy="55" r="35" stroke="#0079C1"/>
                        <circle class="drk-ring" cx="55" cy="45" r="35" stroke="#00A859"/>
                    </svg>
                </div>
                <h2 id="landing-title" class="text-3xl font-black text-drk-900 mb-2 text-center">DRK COMPARADOR</h2>
                <p class="text-slate-500 mb-6 text-center">Selecciona el modo de comparación y la tarifa que deseas analizar.</p>
                
                <!-- SELECTORES DE MODO -->
                <div id="mode-selector-container" class="mb-4 pt-4 border-t border-slate-200">
                    <p class="text-sm font-bold text-drk-800 mb-3 text-center uppercase tracking-wider">MODO DE COMPARACIÓN</p>
                    <div id="comparison-mode-selectors" class="flex flex-wrap justify-center gap-2 text-sm">
                        <!-- DRK Unicamente -->
                        <label class="mode-selector flex-1 px-2 py-2 rounded-lg cursor-pointer transition border-2 text-slate-600 bg-white">
                            <input type="radio" name="comparison_mode" value="drk_only" class="hidden">
                            <span class="font-semibold flex items-center justify-between w-full">DRK Únicamente<svg class="w-4 h-4 ml-1 checkmark-icon hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></span>
                        </label>
                        <!-- DRK Prioritario (Default selected) -->
                        <label class="mode-selector flex-1 px-2 py-2 rounded-lg cursor-pointer transition border-2">
                            <input type="radio" name="comparison_mode" value="drk_prioritized" class="hidden" checked>
                            <span class="font-semibold flex items-center justify-between w-full">DRK Prioritario<svg class="w-4 h-4 ml-1 checkmark-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></span>
                        </label>
                        <!-- Power Cup Global -->
                        <label class="mode-selector flex-1 px-2 py-2 rounded-lg cursor-pointer transition border-2 text-slate-600 bg-white">
                            <input type="radio" name="comparison_mode" value="overall_best" class="hidden">
                            <span class="font-black flex flex-col items-center justify-center w-full leading-tight">
                                <span class="text-base">POWER CUP</span><span class="text-xs font-semibold -mt-0.5">Global</span>
                            </span>
                            <svg class="w-4 h-4 ml-1 checkmark-icon hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                        </label>
                    </div>
                </div>
                
                <!-- BOTÓN MULTICUPS -->
                <div class="mt-4 mb-6 text-center">
                    <button id="multicups-mode-btn" onclick="toggleMulticupsMode()" class="w-2/3 mx-auto bg-slate-100 hover:bg-slate-200 text-slate-700 font-bold py-2 px-4 rounded-xl shadow-md transition transform active:scale-95 text-sm flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" /></svg>
                        Multicups
                    </button>
                </div>
                <!-- FIN BOTÓN MULTICUPS -->
                
                <div class="w-full space-y-4">
                    <!-- 2.0 TD Button -->
                    <button onclick="selectTariffType('2.0TD')" class="tariff-select-btn group">
                        <div class="icon-wrapper">
                            <!-- Icono Casa (Hogar / Pequeño Negocio) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                        </div>
                        <div class="text-left">
                            <span class="text-lg font-bold text-drk-900">2.0 TD</span>
                            <span class="block text-xs text-slate-500">Hogar / Pequeño Negocio</span>
                        </div>
                        <span class="arrow-icon">&rarr;</span>
                    </button>

                    <!-- 3.0 TD Button -->
                    <button onclick="selectTariffType('3.0TD')" class="tariff-select-btn group">
                        <div class="icon-wrapper">
                            <!-- Icono Edificio (Industria / Gran Consumo) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.18a2 2 0 0 0 1.51-.72L11 1l2 2h3.18a2 2 0 0 0 1.51.72L20 5h1.18a2 2 0 0 1 2 2z"></path><path d="M14 9H8v8h8V9z"></path></svg>
                        </div>
                        <div class="text-left">
                            <span class="text-lg font-bold text-drk-900">3.0 TD</span>
                            <span class="block text-xs text-slate-500">Industria / Gran Consumo</span>
                        </div>
                        <span class="arrow-icon">&rarr;</span>
                    </button>

                    <!-- 6.1 TD Button -->
                    <button onclick="selectTariffType('6.1TD')" class="tariff-select-btn group">
                        <div class="icon-wrapper">
                            <!-- Icono Rayo (Alta Tensión) -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M13 3v7h6l-8 11V14H5l8-11z"></path></svg>
                        </div>
                        <div class="text-left">
                            <span class="text-lg font-bold text-drk-900">6.1 TD</span>
                            <span class="block text-xs text-slate-500">Alta Tensión</span>
                        </div>
                        <span class="arrow-icon">&rarr;</span>
                    </button>
                </div>
                
                <!-- PWA Install QR -->
                <div id="pwa-install-section" class="mt-8 pt-4 border-t border-slate-200 text-center">
                    <label class="flex items-center justify-center cursor-pointer mb-3 text-drk-800 hover:text-drk-900 transition">
                        <input type="checkbox" id="qr-toggle-checkbox" class="h-4 w-4 text-drk-500 border-gray-300 rounded focus:ring-drk-500 mr-2">
                        <span class="text-xs font-bold uppercase tracking-wider underline decoration-drk-500 decoration-2 underline-offset-4">Abrir en el Movil</span>
                    </label>
                    <div id="qr-content-wrapper" class="opacity-0 max-h-0">
                        <div id="qr-visual-container" class="mx-auto w-44 h-44 p-2">
                            <div id="qr-code-container"></div>
                        </div>
                        <p class="text-xs text-slate-500 mt-3">Haz una foto del QR y ábrelo en tu móvil.</p>
                    </div>
                </div>

            </div>
        </div>

        <!-- 2. VISTA PRINCIPAL (SCANNER/INPUT) -->
        <div id="initial-view" class="fade-in hidden">
            <button onclick="resetToLanding()" class="mb-4 text-sm text-slate-500 hover:text-drk-600 flex items-center gap-1">
                &larr; Volver a selección
            </button>

            <div id="initial-card" class="bg-white p-6 rounded-3xl shadow-xl text-center border-t-4 border-drk-500 relative">
                <div id="tariff-badge" class="absolute top-4 right-4 bg-drk-500 px-2 py-1 rounded-full text-white text-xs font-bold shadow-md">
                    <span id="current-tariff-label">2.0TD</span> - <span id="tariff-display-badge">0</span>
                </div>
                
                
                <div id="initial-icon-bg" class="w-16 h-16 bg-drk-50 rounded-full flex items-center justify-center mx-auto mb-4 text-drk-600"></div>
                
                <h2 class="text-2xl font-bold text-slate-800 mb-2">Analizar Factura</h2>
                <p class="text-slate-500 mb-6" id="scan-instruction-text">Escanea el código QR o introduce datos manualmente.</p>
                
                <!-- Botones Principales -->
                <!-- CONTENEDOR DE BOTONES QR (Solo para 2.0TD) -->
                <div id="qr-buttons-container">
                    <button id="start-scan-btn" class="w-full bg-gradient-to-r from-drk-600 to-drk-800 hover:from-drk-700 hover:to-drk-900 text-white font-bold py-4 px-6 rounded-2xl shadow-lg transform transition active:scale-95 flex items-center justify-center gap-3 mb-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.125 3h3.75a2 2 0 011.664.89l.812 1.22a2 2 0 001.664.89H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        <span>ESCANEAR QR AHORA</span>
                    </button>
                    <input type="file" id="image-file-input" accept="image/*" class="hidden">
                    <button id="upload-menu-btn" class="w-full bg-drk-50 hover:bg-drk-100 text-drk-800 font-bold py-3 px-6 rounded-xl shadow-sm transform transition active:scale-95 flex items-center justify-center gap-3">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1m-4-5l-1-1m0 0l-1-1m0 0l-1-1M12 12v.01"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>
                        <span>OPCIONES QR MANUAL</span>
                    </button>
                </div>
                <!-- BOTÓN DE DATOS A MANO -->
                <button id="manual-input-btn" class="w-full bg-drk-50 hover:bg-drk-100 text-drk-800 font-bold py-3 px-6 rounded-xl shadow-sm transform transition active:scale-95 flex items-center justify-center gap-3 mt-3">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                    <span>DATOS A MANO</span>
                </button>

                <p id="loading-status" class="text-center text-sm text-slate-400 mt-4 hidden">Cargando tarifas...</p>

            </div>
        </div>

        <!-- 3. VISTA ESCÁNER -->
        <div id="scanner-view" class="hidden flex-col h-full">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-bold text-slate-700">Escaneando...</h2>
                <button id="stop-scan-btn" class="text-red-500 font-bold text-sm bg-red-50 px-3 py-1 rounded-lg">Cancelar</button>
            </div>
            <div class="relative w-full aspect-[3/4] bg-black rounded-2xl overflow-hidden shadow-2xl mb-4">
                <div id="interactive" class="viewport w-full h-full"></div>
                <div id="scanner-guide" class="absolute inset-0 border-2 border-drk-500 opacity-50 m-8 rounded-lg pointer-events-none"></div>
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none"><div class="w-64 h-1 bg-red-500 opacity-50"></div></div>
            </div>
            <p class="text-center text-sm text-slate-500 mb-4">Enfoca el código QR de la CNMC.</p>
            <button id="capture-photo-btn" class="w-full bg-white border-2 border-drk-500 text-drk-800 font-bold py-3 rounded-xl shadow-sm flex items-center justify-center gap-2">Capturar Foto Manualmente</button>
        </div>

        <!-- 4. VISTA RESULTADOS (INDIVIDUAL) -->
        <div id="results-view" class="hidden animate-fade-in-up">
            <div class="text-center mb-6">
                <div class="inline-flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-bold mb-2">
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Análisis Completado
                </div>
                <h2 class="2xl font-black text-slate-800">Resultado del Estudio</h2>
                <p class="text-sm text-slate-500">CUPS: <span id="cups-value" class="font-mono text-slate-700"></span></p>
            </div>

            <div id="result-card" class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-100 mb-8 relative">
                <div id="result-header" class="bg-gradient-to-r from-drk-800 to-drk-600 p-6 text-white text-center relative overflow-hidden">
                    <p class="uppercase tracking-widest text-xs font-semibold text-drk-100 mb-1" id="best-offer-label">LA MEJOR OPCIÓN PARA TI ES</p>
                    <h2 id="best-offer-name" class="text-2xl md:text-3xl font-extrabold leading-tight mb-2">Nombre Tarifa</h2>
                    <p id="best-offer-desc" class="text-drk-100 text-sm opacity-90">Descripción</p>
                </div>
                <div class="p-6">
                    <div class="flex flex-col gap-6">
                        <div class="text-center">
                            <p class="text-slate-500 text-xs font-bold uppercase tracking-wider mb-1">Tu Ahorro Anual Estimado</p>
                            <p id="savings-estimate" class="text-5xl font-black text-green-500 tracking-tight">- €</p>
                        </div>
                        <div class="w-full grid grid-cols-2 text-center text-sm border-b pb-4 border-slate-100">
                            <div class="border-r border-slate-200 pr-2">
                                <p class="text-slate-400 text-xs font-semibold mb-2 uppercase">TU FACTURA ACTUAL</p>
                                <div class="mb-3">
                                    <p class="text-xl font-bold text-red-400 line-through decoration-red-400/50 decoration-2" id="old-period-cost-display">0,00 €</p>
                                    <p class="text-xs text-slate-500 font-medium" id="old-period-days-label">Total Periodo</p> 
                                </div>
                                <div><p class="lg font-bold text-red-500 line-through decoration-red-500/50 decoration-2" id="old-annual-cost-display">0,00 €/año</p></div>
                            </div>
                            <div class="pl-2">
                                <p class="text-drk-800 text-xs font-semibold mb-2 uppercase" id="new-cost-label">TU NUEVO COSTE DRK</p>
                                <div class="mb-3">
                                    <p class="text-2xl font-black text-drk-900" id="new-monthly-cost-display">0,00 €/mes</p>
                                    <p class="text-xs text-drk-800 font-medium" id="monthly-label">Estimado Mensual</p>
                                </div>
                                <div><p class="text-2xl font-black text-drk-900" id="new-annual-cost-display">0,00 €/año</p></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 gap-3 mb-8">
                <button id="send-offer-btn" class="w-full bg-cta-red-500 hover:bg-cta-red-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform transition active:scale-95 flex items-center justify-center gap-3 mb-3">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-2m-4-4l-4 4m0 0l-4-4m4 4V5"></path></svg>
                    <span>COPIAR COMPARATIVO</span>
                </button>
                <button onclick="document.getElementById('details-container').classList.toggle('hidden')" class="text-center text-drk-800 font-bold text-sm hover:underline flex items-center justify-center gap-1" id="details-toggle-btn">Ver desglose detallado del cálculo</button>
            </div>
            
            <!-- CONTENEDOR DE NAVEGACIÓN MULTICUPS -->
            <div id="multicups-navigation-btns" class="grid grid-cols-2 gap-3 mb-8 hidden">
                <button id="next-study-btn" class="w-full bg-drk-500 hover:bg-drk-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform transition active:scale-95 flex items-center justify-center gap-3">
                    Siguiente Estudio &rarr;
                </button>
                <button id="finish-multicups-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform transition active:scale-95 flex items-center justify-center gap-3">
                    Finalizar
                </button>
            </div>
            <!-- FIN CONTENEDOR DE NAVEGACIÓN MULTICUPS -->
            
            <!-- CONTENEDOR DE DESGLOSE DE DETALLES -->
            <div id="details-container" class="hidden space-y-6">
                <!-- Este contenido será llenado por renderResultsUI -->
            </div>

            <div id="single-mode-reset-btn" class="mt-8">
                <button onclick="resetToLanding()" class="w-full bg-white border-2 border-slate-200 hover:border-drk-500 text-slate-600 hover:text-drk-800 font-bold py-4 rounded-xl transition flex items-center justify-center gap-2">
                    Realizar Nueva Comparación
                </button>
            </div>
        </div>
        
        <!-- 5. VISTA RESUMEN MULTICUPS -->
        <div id="multicups-summary-view" class="hidden animate-fade-in-up">
            <div class="text-center mb-6">
                <div class="inline-flex items-center gap-2 bg-green-100 text-green-800 px-3 py-1 rounded-full text-xs font-bold mb-2">
                    <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Resumen Multicups
                </div>
                <h2 class="text-3xl font-black text-slate-800">Ahorro Total Global</h2>
                <p class="text-sm text-slate-500">Resultado de <span id="multicups-count" class="font-mono text-slate-700">0</span> estudios</p>
            </div>

            <!-- Resumen Global -->
            <div id="global-summary-card" class="bg-white rounded-3xl shadow-2xl overflow-hidden border border-slate-100 mb-8 relative">
                <div class="bg-gradient-to-r from-green-700 to-green-500 p-6 text-white text-center relative overflow-hidden">
                    <p class="uppercase tracking-widest text-xs font-semibold text-green-100 mb-1">AHORRO TOTAL ANUAL ESTIMADO</p>
                    <h2 id="multicups-total-savings" class="text-4xl md:text-5xl font-extrabold leading-tight mb-2">0,00 €</h2>
                </div>
                <div class="p-6">
                    <div class="w-full grid grid-cols-2 text-center text-sm">
                        <div class="border-r border-slate-200 pr-2">
                            <p class="text-slate-400 text-xs font-semibold mb-2 uppercase">COSTE ANUAL ACTUAL</p>
                            <p class="text-xl font-bold text-red-400 line-through decoration-red-400/50 decoration-2" id="multicups-old-annual-cost">0,00 €/año</p>
                        </div>
                        <div class="pl-2">
                            <p class="text-drk-800 text-xs font-semibold mb-2 uppercase">NUEVO COSTE ANUAL TOTAL</p>
                            <p class="text-xl font-black text-drk-900" id="multicups-new-annual-cost">0,00 €/año</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-1 gap-3 mb-8">
                <button id="copy-multicups-btn" class="w-full bg-cta-red-500 hover:bg-cta-red-600 text-white font-bold py-3 px-6 rounded-xl shadow-lg transform transition active:scale-95 flex items-center justify-center gap-3 mb-3">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-2m-4-4l-4 4m0 0l-4-4m4 4V5"></path></svg>
                    <span>COPIAR ESTUDIO</span>
                </button>
                <button onclick="resetToLanding()" class="w-full bg-white border-2 border-slate-200 hover:border-drk-500 text-slate-600 hover:text-drk-800 font-bold py-4 rounded-xl transition flex items-center justify-center gap-2">
                    Empezar de Nuevo
                </button>
            </div>

            <!-- Desglose por CUPS y Estudios Individuales -->
            <div id="multicups-details-container" class="space-y-6 mt-8">
                <!-- Rellenado por JS: Resumen de CUPS, Suma Ahorro, Estudios 1 a 1 -->
            </div>
        </div>


        <!-- MODALES -->
        <!-- Modal Datos Manuales -->
        <div id="manual-input-modal" class="fixed inset-0 bg-black/80 hidden items-center justify-center p-4 z-50 backdrop-blur-sm">
            <div class="bg-white p-6 rounded-2xl shadow-2xl max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <h3 class="xl font-bold text-drk-800 mb-4" id="manual-modal-title">Entrada de Datos Manual</h3>
                <div class="border-b border-slate-200 pb-3 mb-4 bg-slate-50 p-3 rounded-lg">
                    <h4 class="font-bold text-slate-800 mb-2">Datos Generales</h4>
                    <input type="text" id="input-cups" placeholder="Número CUPS" class="w-full mb-3 p-3 rounded-lg border border-slate-300 text-sm focus:outline-none focus:border-2 focus:border-drk-500">
                    <input type="number" id="input-billing-days" placeholder="Días Facturados" class="w-full p-3 rounded-lg border border-slate-300 text-sm focus:outline-none focus:border-2 focus:focus:border-drk-500">
                </div>
                
                <!-- Inputs Dinámicos (P1-P6) -->
                <div class="border-b border-slate-200 pb-3 mb-3">
                    <h4 class="font-bold text-slate-800 mb-2">Potencias (kW)</h4>
                    <div class="grid grid-cols-2 gap-2">
                        <input type="number" step="0.01" id="input-p1-kw" placeholder="P1" class="p-2 border rounded text-sm focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="0.01" id="input-p2-kw" placeholder="P2" class="p-2 border rounded text-sm focus:outline-none focus:border-2 focus:border-drk-500">
                        <!-- Extra para 3.0TD/6.1TD -->
                        <input type="number" step="0.01" id="input-p3-kw" placeholder="P3" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="0.01" id="input-p4-kw" placeholder="P4" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="0.01" id="input-p5-kw" placeholder="P5" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="0.01" id="input-p6-kw" placeholder="P6" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                    </div>
                </div>
                
                <!-- Inputs Dinámicos (E1-E6) -->
                <div class="border-b border-slate-200 pb-3 mb-3">
                    <h4 class="font-bold text-slate-800 mb-2">Energía (kWh)</h4>
                    <div class="grid grid-cols-2 gap-2">
                        <input type="number" step="1" id="input-e1-kwh" placeholder="E1" class="p-2 border rounded text-sm focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="1" id="input-e2-kwh" placeholder="E2" class="p-2 border rounded text-sm focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="1" id="input-e3-kwh" placeholder="E3" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                        <!-- Extra para 3.0TD/6.1TD -->
                        <input type="number" step="1" id="input-e4-kwh" placeholder="E4" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="1" id="input-e5-kwh" placeholder="E5" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                        <input type="number" step="1" id="input-e6-kwh" placeholder="E6" class="p-2 border rounded text-sm hidden-period focus:outline-none focus:border-2 focus:border-drk-500">
                    </div>
                </div>

                <div class="pb-3 mb-3">
                    <input type="number" step="0.01" id="input-total-bill" placeholder="Total Factura (€)" class="w-full mb-4 p-3 rounded-lg border border-slate-300 text-sm font-bold focus:outline-none focus:border-2 focus:border-drk-500">
                </div>
                
                <button id="execute-manual-input-btn" class="w-full bg-drk-500 hover:bg-drk-600 text-white font-bold py-3 rounded-xl shadow-md mb-3">CALCULAR</button>
                <button onclick="document.getElementById('manual-input-modal').classList.add('hidden'); document.getElementById('manual-input-modal').classList.remove('flex');" class="w-full bg-slate-200 text-slate-600 font-bold py-3 rounded-xl text-sm">Cancelar</button>
            </div>
        </div>

        <!-- Modal Opciones QR -->
        <div id="qr-options-modal" class="fixed inset-0 bg-black/80 hidden items-center justify-center p-4 z-50 backdrop-blur-sm">
            <div class="bg-white p-6 rounded-2xl shadow-2xl max-w-sm w-full">
                <h3 class="xl font-bold text-drk-800 mb-4" id="modal-qr-title">Seleccione Opción</h3>
                <button id="modal-upload-file-btn" class="w-full bg-drk-800 hover:bg-drk-900 text-white font-bold py-3 px-6 rounded-xl shadow-md mb-3">Subir Imagen</button>
                <button id="modal-paste-image-btn" class="w-full bg-drk-600 hover:bg-drk-800 text-white font-bold py-3 px-6 rounded-xl shadow-md mb-4">Pegar Imagen (CTRL+V)</button>
                <button onclick="document.getElementById('qr-options-modal').classList.add('hidden'); document.getElementById('qr-options-modal').classList.remove('flex');" class="w-full bg-slate-200 font-bold py-3 rounded-xl">Cancelar</button>
            </div>
        </div>

        <!-- Modal Datos Comercial y Cliente -->
        <div id="send-offer-modal" class="fixed inset-0 bg-black/80 hidden items-center justify-center p-4 z-50 backdrop-blur-sm">
            </div>
        </div>
        <!-- /MODALES -->
    </div> <!-- /#app -->

    <script>
        // --- Global State ---
        let currentTariff = '2.0TD'; // Default
        let currentTariffPeriods = 2; // Default 2.0TD
        let isMulticupsMode = false;
        let currentView = 'landing-view';
        let comparisonMode = 'drk_prioritized'; // drk_only, drk_prioritized, overall_best

        // --- Utility Functions ---

        /**
         * Alterna la visibilidad entre vistas de la aplicación.
         * @param {string} viewId - ID de la vista a mostrar.
         */
        function switchView(viewId) {
            const views = ['landing-view', 'initial-view', 'scanner-view', 'results-view', 'multicups-summary-view'];
            views.forEach(id => {
                const view = document.getElementById(id);
                if (view) {
                    view.classList.add('hidden');
                    view.classList.remove('flex');
                }
            });

            const nextView = document.getElementById(viewId);
            if (nextView) {
                if (viewId === 'scanner-view') {
                    nextView.classList.add('flex'); // Scanner needs flex
                }
                nextView.classList.remove('hidden');
            }
            currentView = viewId;
            console.log(`Switched to view: ${viewId}`);
        }

        /**
         * Actualiza la UI para mostrar u ocultar los periodos P3 a P6
         * en los modales de entrada manual.
         * @param {number} periods - Número de periodos de la tarifa (2, 3 o 6).
         */
        function updatePeriodVisibility(periods) {
            const periodIds = [3, 4, 5, 6];
            periodIds.forEach(i => {
                const pKw = document.getElementById(`input-p${i}-kw`);
                const eKwh = document.getElementById(`input-e${i}-kwh`);
                const elements = [pKw, eKwh];

                elements.forEach(el => {
                    if (el) {
                        if (i <= periods) {
                            el.classList.remove('hidden-period');
                        } else {
                            el.classList.add('hidden-period');
                        }
                    }
                });
            });

            // Update modal title helper text
            const modalTitle = document.getElementById('manual-modal-title');
            if (modalTitle) {
                modalTitle.textContent = `Entrada Manual ${periods === 2 ? 2 : 6} Periodos`;
            }

            currentTariffPeriods = periods;
        }

        /**
         * Maneja la selección de la tarifa desde la vista de inicio (Landing).
         * Este es el arreglo principal para el ReferenceError.
         * @param {string} tariffType - El tipo de tarifa seleccionado ('2.0TD', '3.0TD', '6.1TD').
         */
        function selectTariffType(tariffType) {
            currentTariff = tariffType;
            let periods;

            // Determinar el número de periodos y actualizar el icono
            const initialIconBg = document.getElementById('initial-icon-bg');
            let iconSvg = '';

            switch (tariffType) {
                case '2.0TD':
                    periods = 2;
                    // Icono Casa
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>';
                    // Solo 2.0TD puede escanear QR
                    document.getElementById('qr-buttons-container').classList.remove('hidden');
                    document.getElementById('scan-instruction-text').textContent = "Escanea el código QR o introduce datos manualmente.";
                    break;
                case '3.0TD':
                    periods = 6;
                    // Icono Edificio
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.18a2 2 0 0 0 1.51-.72L11 1l2 2h3.18a2 2 0 0 0 1.51.72L20 5h1.18a2 2 0 0 1 2 2z"></path><path d="M14 9H8v8h8V9z"></path></svg>';
                    // Ocultar QR para tarifas no domésticas (simplificación)
                    document.getElementById('qr-buttons-container').classList.add('hidden');
                    document.getElementById('scan-instruction-text').textContent = "Introduce datos manualmente para tarifas complejas.";
                    break;
                case '6.1TD':
                    periods = 6;
                    // Icono Rayo
                    iconSvg = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8"><path d="M13 3v7h6l-8 11V14H5l8-11z"></path></svg>';
                    // Ocultar QR para tarifas no domésticas (simplificación)
                    document.getElementById('qr-buttons-container').classList.add('hidden');
                    document.getElementById('scan-instruction-text').textContent = "Introduce datos manualmente para tarifas complejas.";
                    break;
            }
            
            // Actualizar la UI
            if (initialIconBg) {
                initialIconBg.innerHTML = iconSvg;
                initialIconBg.classList.remove('bg-drk-50', 'text-drk-600', 'bg-powercup-50', 'text-powercup-600');
                // Use DRK branding colors for the icon/bg on the initial view
                initialIconBg.classList.add('bg-drk-50', 'text-drk-600');
            }

            document.getElementById('current-tariff-label').textContent = tariffType;
            document.getElementById('tariff-display-badge').textContent = `${periods}P`;
            
            updatePeriodVisibility(periods);
            switchView('initial-view');
        }

        /**
         * Vuelve a la vista de selección de tarifa (Landing Page).
         */
        function resetToLanding() {
            // Reinicia el estado de multicups si es necesario
            if (isMulticupsMode) {
                // Lógica de reinicio de multicups (por implementar)
            }
            switchView('landing-view');
            // Ocultar modales si están abiertos
            document.getElementById('manual-input-modal').classList.add('hidden');
            document.getElementById('manual-input-modal').classList.remove('flex');
            document.getElementById('qr-options-modal').classList.add('hidden');
            document.getElementById('qr-options-modal').classList.remove('flex');

            // Asegura que el modo activo se refleje en el estilo de la landing
            updateLandingStyle(comparisonMode);
        }

        /**
         * Alterna el modo Multicups.
         */
        function toggleMulticupsMode() {
            isMulticupsMode = !isMulticupsMode;
            const btn = document.getElementById('multicups-mode-btn');
            if (btn) {
                if (isMulticupsMode) {
                    btn.classList.add('bg-drk-500', 'text-white', 'hover:bg-drk-600');
                    btn.classList.remove('bg-slate-100', 'text-slate-700', 'hover:bg-slate-200');
                    btn.querySelector('span').textContent = 'Multicups ACTIVO';
                } else {
                    btn.classList.remove('bg-drk-500', 'text-white', 'hover:bg-drk-600');
                    btn.classList.add('bg-slate-100', 'text-slate-700', 'hover:bg-slate-200');
                    btn.querySelector('span').textContent = 'Multicups';
                }
            }
        }
        
        /**
         * Actualiza los estilos globales y de la landing page según el modo de comparación.
         * @param {string} mode - 'drk_only', 'drk_prioritized', or 'overall_best'.
         */
        function updateLandingStyle(mode) {
            const body = document.body;
            const landingCard = document.getElementById('landing-card');
            const landingIconBg = document.getElementById('landing-icon-bg');
            const appLogoMain = document.getElementById('app-logo-main');
            const appLogoAccent = document.getElementById('app-logo-accent');
            const navbar = document.getElementById('navbar');

            // 1. Reset classes
            body.classList.remove('drk-active', 'powercup-active');
            landingCard.classList.remove('border-drk-500', 'border-powercup-500');
            navbar.classList.remove('bg-drk-900', 'bg-powercup-900', 'transition-colors');
            appLogoMain.classList.remove('text-drk-500', 'text-powercup-500');
            appLogoAccent.classList.remove('text-drk-500', 'text-powercup-500');
            landingIconBg.classList.remove('bg-drk-50', 'text-drk-600', 'bg-powercup-50', 'text-powercup-600');

            // 2. Apply classes based on mode
            if (mode === 'drk_only' || mode === 'drk_prioritized') {
                body.classList.add('drk-active');
                landingCard.classList.add('border-drk-500');
                navbar.classList.add('bg-drk-900');
                appLogoAccent.classList.add('text-drk-500');
                landingIconBg.classList.add('bg-drk-50', 'text-drk-600');
                document.getElementById('app-logo-main').textContent = 'DRK';
                document.getElementById('app-logo-accent').textContent = 'Energía';
            } else if (mode === 'overall_best') {
                body.classList.add('powercup-active');
                landingCard.classList.add('border-powercup-500');
                navbar.classList.add('bg-powercup-900');
                appLogoAccent.classList.add('text-powercup-500');
                landingIconBg.classList.add('bg-powercup-50', 'text-powercup-600');
                document.getElementById('app-logo-main').textContent = 'POWER';
                document.getElementById('app-logo-accent').textContent = 'CUP';
            }

            // 3. Update radio button UI
            const radioButtons = document.querySelectorAll('input[name="comparison_mode"]');
            radioButtons.forEach(radio => {
                const label = radio.parentElement;
                const checkmark = label.querySelector('.checkmark-icon');
                label.classList.remove('border-drk-500', 'bg-drk-50', 'text-drk-800', 'border-powercup-500', 'bg-powercup-50', 'text-powercup-800', 'bg-white', 'text-slate-600');

                if (radio.value === mode) {
                    checkmark.classList.remove('hidden');
                    if (mode === 'overall_best') {
                        label.classList.add('border-powercup-500', 'bg-powercup-50', 'text-powercup-800');
                        checkmark.setAttribute('stroke', '#84cc16'); // powercup-500
                    } else {
                        label.classList.add('border-drk-500', 'bg-drk-50', 'text-drk-800');
                        checkmark.setAttribute('stroke', '#0ea5e9'); // drk-500
                    }
                } else {
                    checkmark.classList.add('hidden');
                    label.classList.add('bg-white', 'text-slate-600', 'border-slate-200');
                    checkmark.setAttribute('stroke', 'currentColor');
                }
            });
        }
        
        /**
         * Inicializa la aplicación y añade listeners para el cambio de modo.
         */
        document.addEventListener('DOMContentLoaded', () => {
            // Inicializar vista al estado por defecto
            switchView('landing-view');
            
            // Inicializar el estilo del modo de comparación por defecto
            updateLandingStyle(comparisonMode); 

            // Listener para los selectores de modo
            const modeSelectors = document.querySelectorAll('input[name="comparison_mode"]');
            modeSelectors.forEach(radio => {
                radio.addEventListener('change', (event) => {
                    comparisonMode = event.target.value;
                    updateLandingStyle(comparisonMode);
                    console.log(`Comparison Mode set to: ${comparisonMode}`);
                });
            });

            // Listener para el toggle del QR
            const qrToggleCheckbox = document.getElementById('qr-toggle-checkbox');
            const qrContentWrapper = document.getElementById('qr-content-wrapper');

            if (qrToggleCheckbox) {
                qrToggleCheckbox.addEventListener('change', () => {
                    if (qrToggleCheckbox.checked) {
                        qrContentWrapper.classList.add('active');
                        // Lógica para generar QR (simulada aquí, se completaría con la URL real)
                        const qrContainer = document.getElementById('qr-code-container');
                        if (qrContainer && !qrContainer.querySelector('canvas')) {
                            // Asumiendo que la URL de la aplicación está disponible globalmente.
                            new QRCode(qrContainer, {
                                text: window.location.href || "https://canvas.google.com/drk-comparador",
                                width: 150,
                                height: 150,
                                colorDark: "#0c4a6e", // drk-900
                                colorLight: "#ffffff",
                                correctLevel: QRCode.CorrectLevel.H
                            });
                            // Actualizar el estilo del QR según el modo activo (DRK por defecto)
                            const qrVisualContainer = document.getElementById('qr-visual-container');
                            qrVisualContainer.style.setProperty('--qr-border-color', '#0ea5e9');
                            qrVisualContainer.style.setProperty('--qr-center-bg', '#0c4a6e');
                            qrVisualContainer.style.setProperty('--qr-center-text', '"DRK"');
                        }
                    } else {
                        qrContentWrapper.classList.remove('active');
                    }
                });
            }
        });


        // --- DUMMY Functions for buttons used in initial-view/modals (to prevent errors) ---
        // Estas funciones se asignan a los botones para evitar ReferenceErrors en la consola hasta que se implemente la funcionalidad completa.

        function startScan() {
            console.warn("Function startScan not implemented yet. Switching to scanner-view.");
            switchView('scanner-view'); 
        }
        if (document.getElementById('start-scan-btn')) {
            document.getElementById('start-scan-btn').onclick = startScan;
        }


        function openManualInputModal() {
             document.getElementById('manual-input-modal').classList.add('flex');
             document.getElementById('manual-input-modal').classList.remove('hidden');
        }
        if (document.getElementById('manual-input-btn')) {
            document.getElementById('manual-input-btn').onclick = openManualInputModal;
        }

        function openQrOptionsModal() {
             document.getElementById('qr-options-modal').classList.add('flex');
             document.getElementById('qr-options-modal').classList.remove('hidden');
        }
        if (document.getElementById('upload-menu-btn')) {
            document.getElementById('upload-menu-btn').onclick = openQrOptionsModal;
        }


        // Asignar funciones a otros botones para evitar ReferenceErrors
        if (document.getElementById('execute-manual-input-btn')) {
            document.getElementById('execute-manual-input-btn').onclick = () => console.warn("Execute Manual Input not implemented.");
        }
        if (document.getElementById('stop-scan-btn')) {
            document.getElementById('stop-scan-btn').onclick = () => switchView('initial-view');
        }
        if (document.getElementById('capture-photo-btn')) {
            document.getElementById('capture-photo-btn').onclick = () => console.warn("Capture photo not implemented.");
        }
        if (document.getElementById('send-offer-btn')) {
            document.getElementById('send-offer-btn').onclick = () => console.warn("Send offer not implemented.");
        }
        if (document.getElementById('next-study-btn')) {
            document.getElementById('next-study-btn').onclick = () => console.warn("Next study not implemented.");
        }
        if (document.getElementById('finish-multicups-btn')) {
            document.getElementById('finish-multicups-btn').onclick = () => console.warn("Finish multicups not implemented.");
        }
        if (document.getElementById('copy-multicups-btn')) {
            document.getElementById('copy-multicups-btn').onclick = () => console.warn("Copy multicups not implemented.");
        }
        if (document.getElementById('modal-upload-file-btn')) {
            document.getElementById('modal-upload-file-btn').onclick = () => console.warn("Upload file not implemented.");
        }
        if (document.getElementById('modal-paste-image-btn')) {
            document.getElementById('modal-paste-image-btn').onclick = () => console.warn("Paste image not implemented.");
        }
    </script>
</body>
</html>
